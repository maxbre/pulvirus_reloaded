========================================================================= 
Log Path: ./log/no2_IT1176A.log 
Working Directory: /home/rmorelli/R/pulvirus_reloaded 
User Name: rmorelli 
R Version: 4.3.1 (2023-06-16) 
Machine: annuario x86_64 
Operating System: Linux 5.10.0-8-amd64 #1 SMP Debian 5.10.46-5 (2021-09-23) 
Base Packages: stats graphics grDevices utils datasets methods base Other Packages: datiMeteo_0.0.6 datiInquinanti_0.0.7 glue_1.6.2 stringr_1.5.0 readr_2.1.4 purrr_1.0.2 mgcv_1.9-0 nlme_3.1-163 logr_1.3.4 dplyr_1.1.3 correlation_0.8.4 
Log Start Time: 2023-09-25 10:08:01.355649 
========================================================================= 

# A tibble: 1 × 4
  comune nome_stazione     st_x  st_y
  <chr>  <chr>            <dbl> <dbl>
1 Roma   L.GO PERESTRELLO  12.5  41.9

NOTE: Data frame has 1 rows and 4 columns. 

NOTE: Log Print Time:  2023-09-25 10:08:01.404941 
NOTE: Elapsed Time: 0.0487408638000488 secs 

Modelli NON backward: 

---------- START: ################## 

modelli tra cui scegliere: 14 

Modello migliore: 

log(value) ~ weekday + lock + s(mese, bs = "cc", k = 12) + s(jd, 
    k = 5) + s(pblmin)

Indice: 14 

      [,1]                                                                                               
 [1,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(t2m), data = df)"       
 [2,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(tp), data = df)"        
 [3,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(ptp), data = df)"       
 [4,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(rh), data = df)"        
 [5,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m), data = df)"      
 [6,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(v10m), data = df)"      
 [7,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(wspeed), data = df)"    
 [8,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(wspeed_max), data = df)"
 [9,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(pwspeed), data = df)"   
[10,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(wdir), data = df)"      
[11,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(sp), data = df)"        
[12,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(pbl00), data = df)"     
[13,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(pbl12), data = df)"     
[14,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(pblmin), data = df)"    
      [,2]              
 [1,] "1193.16688215538"
 [2,] "1075.3574277401" 
 [3,] "1184.12300637783"
 [4,] "1264.68137585743"
 [5,] "1137.02677285305"
 [6,] "641.317600440129"
 [7,] "637.471679226319"
 [8,] "1054.72492755948"
 [9,] "1126.36176312297"
[10,] "1117.63018986487"
[11,] "1010.01113530691"
[12,] "756.238510195738"
[13,] "1143.44240493783"
[14,] "527.516493211398"

Variabile scelta: pblmin - AIC 527.52 

Variabili in ICS: 1 

Modelli NON backward: 

---------- START: ################## 

modelli tra cui scegliere: 13 

Modello migliore: 

log(value) ~ weekday + lock + s(mese, bs = "cc", k = 12) + s(jd, 
    k = 5) + s(pblmin) + s(rh)

Indice: 4 

      [,1]                                                                                                           
 [1,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(pblmin) + s(t2m), data = df)"       
 [2,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(pblmin) + s(tp), data = df)"        
 [3,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(pblmin) + s(ptp), data = df)"       
 [4,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(pblmin) + s(rh), data = df)"        
 [5,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(pblmin) + s(u10m), data = df)"      
 [6,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(pblmin) + s(v10m), data = df)"      
 [7,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(pblmin) + s(wspeed), data = df)"    
 [8,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(pblmin) + s(wspeed_max), data = df)"
 [9,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(pblmin) + s(pwspeed), data = df)"   
[10,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(pblmin) + s(wdir), data = df)"      
[11,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(pblmin) + s(sp), data = df)"        
[12,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(pblmin) + s(pbl00), data = df)"     
[13,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(pblmin) + s(pbl12), data = df)"     
      [,2]              
 [1,] "507.972168051184"
 [2,] "527.654656001612"
 [3,] "530.30327431016" 
 [4,] "442.461582391711"
 [5,] "508.419531380119"
 [6,] "460.037131593053"
 [7,] "455.320245736214"
 [8,] "500.097264876528"
 [9,] "560.555021133312"
[10,] "453.252015432371"
[11,] "491.282269958901"
[12,] "496.80501573944" 
[13,] "494.815894386004"

Variabile scelta: rh - AIC 442.46 

Variabili in ICS: 2 

Gli ICS 2 ----- 1 

NOTE: Log Print Time:  2023-09-25 10:08:06.905188 
NOTE: Elapsed Time: 5.50024676322937 secs 

Il modello N è migliore del precedente, verifica del backward 

Modelli backward: 

modelli tra cui scegliere: 12 

Modello migliore: 

log(value) ~ weekday + lock + s(mese, bs = "cc", k = 12) + s(jd, 
    k = 5) + s(rh) + s(wspeed)

Indice: 6 

Dati backward: wspeed - 521.973858455245 

                                                                                                   unlist.w.
1         gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(rh) + s(t2m), data = df)
2          gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(rh) + s(tp), data = df)
3         gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(rh) + s(ptp), data = df)
4        gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(rh) + s(u10m), data = df)
5        gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(rh) + s(v10m), data = df)
6      gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(rh) + s(wspeed), data = df)
7  gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(rh) + s(wspeed_max), data = df)
8     gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(rh) + s(pwspeed), data = df)
9        gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(rh) + s(wdir), data = df)
10         gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(rh) + s(sp), data = df)
11      gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(rh) + s(pbl00), data = df)
12      gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(rh) + s(pbl12), data = df)
   unlist.aicBack..3...
1             1210.4369
2             1078.2994
3             1204.8672
4             1134.9923
5              604.5312
6              521.9739
7             1037.3410
8             1106.6963
9             1136.8110
10            1048.1378
11             714.2178
12            1076.4787

Il backward non è migliore.  Verifica della correlazione per mod(N) 

Modello N: pblmin - rh 

Scelgo il modello N 

Modelli NON backward: 

---------- START: ################## 

modelli tra cui scegliere: 12 

Modello migliore: 

log(value) ~ weekday + lock + s(mese, bs = "cc", k = 12) + s(jd, 
    k = 5) + s(pblmin) + s(rh) + s(wspeed)

Indice: 6 

      [,1]                                                                                                                   
 [1,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(pblmin) + s(rh) + s(t2m), data = df)"       
 [2,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(pblmin) + s(rh) + s(tp), data = df)"        
 [3,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(pblmin) + s(rh) + s(ptp), data = df)"       
 [4,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(pblmin) + s(rh) + s(u10m), data = df)"      
 [5,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(pblmin) + s(rh) + s(v10m), data = df)"      
 [6,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(pblmin) + s(rh) + s(wspeed), data = df)"    
 [7,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(pblmin) + s(rh) + s(wspeed_max), data = df)"
 [8,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(pblmin) + s(rh) + s(pwspeed), data = df)"   
 [9,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(pblmin) + s(rh) + s(wdir), data = df)"      
[10,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(pblmin) + s(rh) + s(sp), data = df)"        
[11,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(pblmin) + s(rh) + s(pbl00), data = df)"     
[12,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(pblmin) + s(rh) + s(pbl12), data = df)"     
      [,2]              
 [1,] "433.060009830484"
 [2,] "467.572756678356"
 [3,] "454.593740974147"
 [4,] "430.822685531414"
 [5,] "373.005765637827"
 [6,] "322.479994464218"
 [7,] "408.046182701788"
 [8,] "466.35582855162" 
 [9,] "405.58496693622" 
[10,] "433.426185508917"
[11,] "425.154726568405"
[12,] "360.353340323941"

Variabile scelta: wspeed - AIC 322.48 

Variabili in ICS: 3 

Gli ICS 3 ----- 2 

NOTE: Log Print Time:  2023-09-25 10:08:12.69381 
NOTE: Elapsed Time: 5.7886221408844 secs 

Il modello N è migliore del precedente, verifica del backward 

Modelli backward: 

modelli tra cui scegliere: 11 

Modello migliore: 

log(value) ~ weekday + lock + s(mese, bs = "cc", k = 12) + s(jd, 
    k = 5) + s(pblmin) + s(wspeed) + s(wdir)

Indice: 8 

Dati backward: wdir - 375.24776067386 

                                                                                                                   unlist.w.
1         gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(pblmin) + s(wspeed) + s(t2m), data = df)
2          gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(pblmin) + s(wspeed) + s(tp), data = df)
3         gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(pblmin) + s(wspeed) + s(ptp), data = df)
4        gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(pblmin) + s(wspeed) + s(u10m), data = df)
5        gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(pblmin) + s(wspeed) + s(v10m), data = df)
6  gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(pblmin) + s(wspeed) + s(wspeed_max), data = df)
7     gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(pblmin) + s(wspeed) + s(pwspeed), data = df)
8        gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(pblmin) + s(wspeed) + s(wdir), data = df)
9          gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(pblmin) + s(wspeed) + s(sp), data = df)
10      gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(pblmin) + s(wspeed) + s(pbl00), data = df)
11      gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(pblmin) + s(wspeed) + s(pbl12), data = df)
   unlist.aicBack..3...
1              423.8202
2              452.6231
3              456.8185
4              435.4818
5              426.6313
6              439.3822
7              492.7520
8              375.2478
9              431.3122
10             437.6576
11             433.6243

Il backward non è migliore.  Verifica della correlazione per mod(N) 

Modello N: pblmin - rh - wspeed 

Scelgo il modello N 

Modelli NON backward: 

---------- START: ################## 

modelli tra cui scegliere: 11 

Modello migliore: 

log(value) ~ weekday + lock + s(mese, bs = "cc", k = 12) + s(jd, 
    k = 5) + s(pblmin) + s(rh) + s(wspeed) + s(pbl12)

Indice: 11 

      [,1]                                                                                                                               
 [1,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(pblmin) + s(rh) + s(wspeed) + s(t2m), data = df)"       
 [2,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(pblmin) + s(rh) + s(wspeed) + s(tp), data = df)"        
 [3,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(pblmin) + s(rh) + s(wspeed) + s(ptp), data = df)"       
 [4,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(pblmin) + s(rh) + s(wspeed) + s(u10m), data = df)"      
 [5,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(pblmin) + s(rh) + s(wspeed) + s(v10m), data = df)"      
 [6,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(pblmin) + s(rh) + s(wspeed) + s(wspeed_max), data = df)"
 [7,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(pblmin) + s(rh) + s(wspeed) + s(pwspeed), data = df)"   
 [8,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(pblmin) + s(rh) + s(wspeed) + s(wdir), data = df)"      
 [9,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(pblmin) + s(rh) + s(wspeed) + s(sp), data = df)"        
[10,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(pblmin) + s(rh) + s(wspeed) + s(pbl00), data = df)"     
[11,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(pblmin) + s(rh) + s(wspeed) + s(pbl12), data = df)"     
      [,2]              
 [1,] "305.410099760924"
 [2,] "352.701484673465"
 [3,] "334.46776321759" 
 [4,] "310.342099778456"
 [5,] "332.602964897211"
 [6,] "306.104175904688"
 [7,] "322.520216462691"
 [8,] "282.201527287376"
 [9,] "329.717546235886"
[10,] "296.667568369203"
[11,] "239.683584718442"

Variabile scelta: pbl12 - AIC 239.68 

Variabili in ICS: 4 

Gli ICS 4 ----- 3 

NOTE: Log Print Time:  2023-09-25 10:08:19.43427 
NOTE: Elapsed Time: 6.74046015739441 secs 

Il modello N è migliore del precedente, verifica del backward 

Modelli backward: 

modelli tra cui scegliere: 10 

Modello migliore: 

log(value) ~ weekday + lock + s(mese, bs = "cc", k = 12) + s(jd, 
    k = 5) + s(pblmin) + s(rh) + s(pbl12) + s(v10m)

Indice: 5 

Dati backward: v10m - 295.221441442983 

                                                                                                                          unlist.w.
1         gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(pblmin) + s(rh) + s(pbl12) + s(t2m), data = df)
2          gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(pblmin) + s(rh) + s(pbl12) + s(tp), data = df)
3         gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(pblmin) + s(rh) + s(pbl12) + s(ptp), data = df)
4        gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(pblmin) + s(rh) + s(pbl12) + s(u10m), data = df)
5        gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(pblmin) + s(rh) + s(pbl12) + s(v10m), data = df)
6  gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(pblmin) + s(rh) + s(pbl12) + s(wspeed_max), data = df)
7     gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(pblmin) + s(rh) + s(pbl12) + s(pwspeed), data = df)
8        gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(pblmin) + s(rh) + s(pbl12) + s(wdir), data = df)
9          gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(pblmin) + s(rh) + s(pbl12) + s(sp), data = df)
10      gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(pblmin) + s(rh) + s(pbl12) + s(pbl00), data = df)
   unlist.aicBack..3...
1              352.5621
2              360.2315
3              375.1893
4              364.3903
5              295.2214
6              319.7248
7              375.8739
8              324.0182
9              362.1092
10             319.3731

Il backward non è migliore.  Verifica della correlazione per mod(N) 

Modello N: pblmin - rh - wspeed - pbl12 

Scelgo il modello N 

Modelli NON backward: 

---------- START: ################## 

modelli tra cui scegliere: 10 

Modello migliore: 

log(value) ~ weekday + lock + s(mese, bs = "cc", k = 12) + s(jd, 
    k = 5) + s(pblmin) + s(rh) + s(wspeed) + s(pbl12) + s(wdir)

Indice: 8 

      [,1]                                                                                                                                          
 [1,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(pblmin) + s(rh) + s(wspeed) + s(pbl12) + s(t2m), data = df)"       
 [2,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(pblmin) + s(rh) + s(wspeed) + s(pbl12) + s(tp), data = df)"        
 [3,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(pblmin) + s(rh) + s(wspeed) + s(pbl12) + s(ptp), data = df)"       
 [4,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(pblmin) + s(rh) + s(wspeed) + s(pbl12) + s(u10m), data = df)"      
 [5,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(pblmin) + s(rh) + s(wspeed) + s(pbl12) + s(v10m), data = df)"      
 [6,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(pblmin) + s(rh) + s(wspeed) + s(pbl12) + s(wspeed_max), data = df)"
 [7,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(pblmin) + s(rh) + s(wspeed) + s(pbl12) + s(pwspeed), data = df)"   
 [8,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(pblmin) + s(rh) + s(wspeed) + s(pbl12) + s(wdir), data = df)"      
 [9,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(pblmin) + s(rh) + s(wspeed) + s(pbl12) + s(sp), data = df)"        
[10,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(pblmin) + s(rh) + s(wspeed) + s(pbl12) + s(pbl00), data = df)"     
      [,2]              
 [1,] "227.554406734857"
 [2,] "268.514371130778"
 [3,] "254.735840928866"
 [4,] "225.854811831421"
 [5,] "252.271854742185"
 [6,] "230.520430760089"
 [7,] "265.71934712549" 
 [8,] "193.76540864543" 
 [9,] "251.305760124945"
[10,] "212.186044033374"

Variabile scelta: wdir - AIC 193.77 

Variabili in ICS: 5 

Gli ICS 5 ----- 4 

NOTE: Log Print Time:  2023-09-25 10:08:26.159036 
NOTE: Elapsed Time: 6.72476577758789 secs 

Il modello N è migliore del precedente, verifica del backward 

Modelli backward: 

modelli tra cui scegliere: 9 

Modello migliore: 

log(value) ~ weekday + lock + s(mese, bs = "cc", k = 12) + s(jd, 
    k = 5) + s(pblmin) + s(rh) + s(wspeed) + s(wdir) + s(t2m)

Indice: 1 

Dati backward: t2m - 258.316267889721 

                                                                                                                                    unlist.w.
1        gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(pblmin) + s(rh) + s(wspeed) + s(wdir) + s(t2m), data = df)
2         gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(pblmin) + s(rh) + s(wspeed) + s(wdir) + s(tp), data = df)
3        gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(pblmin) + s(rh) + s(wspeed) + s(wdir) + s(ptp), data = df)
4       gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(pblmin) + s(rh) + s(wspeed) + s(wdir) + s(u10m), data = df)
5       gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(pblmin) + s(rh) + s(wspeed) + s(wdir) + s(v10m), data = df)
6 gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(pblmin) + s(rh) + s(wspeed) + s(wdir) + s(wspeed_max), data = df)
7    gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(pblmin) + s(rh) + s(wspeed) + s(wdir) + s(pwspeed), data = df)
8         gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(pblmin) + s(rh) + s(wspeed) + s(wdir) + s(sp), data = df)
9      gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(pblmin) + s(rh) + s(wspeed) + s(wdir) + s(pbl00), data = df)
  unlist.aicBack..3...
1             258.3163
2             312.7226
3             297.4941
4             310.8127
5             310.7652
6             268.4137
7             316.3352
8             310.9170
9             301.5692

Il backward non è migliore.  Verifica della correlazione per mod(N) 

Modello N: pblmin - rh - wspeed - pbl12 - wdir 

Scelgo il modello N 

Modelli NON backward: 

---------- START: ################## 

modelli tra cui scegliere: 9 

Modello migliore: 

log(value) ~ weekday + lock + s(mese, bs = "cc", k = 12) + s(jd, 
    k = 5) + s(pblmin) + s(rh) + s(wspeed) + s(pbl12) + s(wdir) + 
    s(t2m)

Indice: 1 

      [,1]                                                                                                                                                    
 [1,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(pblmin) + s(rh) + s(wspeed) + s(pbl12) + s(wdir) + s(t2m), data = df)"       
 [2,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(pblmin) + s(rh) + s(wspeed) + s(pbl12) + s(wdir) + s(tp), data = df)"        
 [3,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(pblmin) + s(rh) + s(wspeed) + s(pbl12) + s(wdir) + s(ptp), data = df)"       
 [4,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(pblmin) + s(rh) + s(wspeed) + s(pbl12) + s(wdir) + s(u10m), data = df)"      
 [5,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(pblmin) + s(rh) + s(wspeed) + s(pbl12) + s(wdir) + s(v10m), data = df)"      
 [6,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(pblmin) + s(rh) + s(wspeed) + s(pbl12) + s(wdir) + s(wspeed_max), data = df)"
 [7,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(pblmin) + s(rh) + s(wspeed) + s(pbl12) + s(wdir) + s(pwspeed), data = df)"   
 [8,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(pblmin) + s(rh) + s(wspeed) + s(pbl12) + s(wdir) + s(sp), data = df)"        
 [9,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(pblmin) + s(rh) + s(wspeed) + s(pbl12) + s(wdir) + s(pbl00), data = df)"     
      [,2]              
 [1,] "175.481846048413"
 [2,] "223.082298777937"
 [3,] "208.859253442441"
 [4,] "215.389041710171"
 [5,] "204.612166656926"
 [6,] "188.484304008173"
 [7,] "225.817132604621"
 [8,] "207.716426865646"
 [9,] "206.708758199187"

Variabile scelta: t2m - AIC 175.48 

Variabili in ICS: 6 

Gli ICS 6 ----- 5 

NOTE: Log Print Time:  2023-09-25 10:08:34.943335 
NOTE: Elapsed Time: 8.78429841995239 secs 

Il modello N è migliore del precedente, verifica del backward 

Modelli backward: 

modelli tra cui scegliere: 8 

Modello migliore: 

log(value) ~ weekday + lock + s(mese, bs = "cc", k = 12) + s(jd, 
    k = 5) + s(pblmin) + s(rh) + s(wspeed) + s(pbl12) + s(t2m) + 
    s(pbl00)

Indice: 8 

Dati backward: pbl00 - 196.217023619492 

                                                                                                                                              unlist.w.
1         gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(pblmin) + s(rh) + s(wspeed) + s(pbl12) + s(t2m) + s(tp), data = df)
2        gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(pblmin) + s(rh) + s(wspeed) + s(pbl12) + s(t2m) + s(ptp), data = df)
3       gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(pblmin) + s(rh) + s(wspeed) + s(pbl12) + s(t2m) + s(u10m), data = df)
4       gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(pblmin) + s(rh) + s(wspeed) + s(pbl12) + s(t2m) + s(v10m), data = df)
5 gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(pblmin) + s(rh) + s(wspeed) + s(pbl12) + s(t2m) + s(wspeed_max), data = df)
6    gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(pblmin) + s(rh) + s(wspeed) + s(pbl12) + s(t2m) + s(pwspeed), data = df)
7         gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(pblmin) + s(rh) + s(wspeed) + s(pbl12) + s(t2m) + s(sp), data = df)
8      gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(pblmin) + s(rh) + s(wspeed) + s(pbl12) + s(t2m) + s(pbl00), data = df)
  unlist.aicBack..3...
1             234.5140
2             240.0291
3             203.5872
4             240.5638
5             214.5539
6             251.4400
7             241.1131
8             196.2170

Il backward non è migliore.  Verifica della correlazione per mod(N) 

Modello N: pblmin - rh - wspeed - pbl12 - wdir - t2m 

Scelgo il modello N 

Modelli NON backward: 

---------- START: ################## 

modelli tra cui scegliere: 8 

Modello migliore: 

log(value) ~ weekday + lock + s(mese, bs = "cc", k = 12) + s(jd, 
    k = 5) + s(pblmin) + s(rh) + s(wspeed) + s(pbl12) + s(wdir) + 
    s(t2m) + s(wspeed_max)

Indice: 5 

     [,1]                                                                                                                                                             
[1,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(pblmin) + s(rh) + s(wspeed) + s(pbl12) + s(wdir) + s(t2m) + s(tp), data = df)"        
[2,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(pblmin) + s(rh) + s(wspeed) + s(pbl12) + s(wdir) + s(t2m) + s(ptp), data = df)"       
[3,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(pblmin) + s(rh) + s(wspeed) + s(pbl12) + s(wdir) + s(t2m) + s(u10m), data = df)"      
[4,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(pblmin) + s(rh) + s(wspeed) + s(pbl12) + s(wdir) + s(t2m) + s(v10m), data = df)"      
[5,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(pblmin) + s(rh) + s(wspeed) + s(pbl12) + s(wdir) + s(t2m) + s(wspeed_max), data = df)"
[6,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(pblmin) + s(rh) + s(wspeed) + s(pbl12) + s(wdir) + s(t2m) + s(pwspeed), data = df)"   
[7,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(pblmin) + s(rh) + s(wspeed) + s(pbl12) + s(wdir) + s(t2m) + s(sp), data = df)"        
[8,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(pblmin) + s(rh) + s(wspeed) + s(pbl12) + s(wdir) + s(t2m) + s(pbl00), data = df)"     
     [,2]              
[1,] "182.889023021424"
[2,] "187.842104237404"
[3,] "196.865082987533"
[4,] "187.889104760176"
[5,] "169.617788210894"
[6,] "206.877831663374"
[7,] "193.142232419721"
[8,] "186.5115526413"  

Variabile scelta: wspeed_max - AIC 169.62 

Variabili in ICS: 7 

Gli ICS 7 ----- 6 

NOTE: Log Print Time:  2023-09-25 10:08:43.308695 
NOTE: Elapsed Time: 8.36536073684692 secs 

Il modello N è migliore del precedente, verifica del backward 

Modelli backward: 

modelli tra cui scegliere: 7 

Modello migliore: 

log(value) ~ weekday + lock + s(mese, bs = "cc", k = 12) + s(jd, 
    k = 5) + s(pblmin) + s(rh) + s(wspeed) + s(pbl12) + s(wdir) + 
    s(wspeed_max) + s(v10m)

Indice: 4 

Dati backward: v10m - 196.298255351434 

                                                                                                                                                            unlist.w.
1      gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(pblmin) + s(rh) + s(wspeed) + s(pbl12) + s(wdir) + s(wspeed_max) + s(tp), data = df)
2     gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(pblmin) + s(rh) + s(wspeed) + s(pbl12) + s(wdir) + s(wspeed_max) + s(ptp), data = df)
3    gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(pblmin) + s(rh) + s(wspeed) + s(pbl12) + s(wdir) + s(wspeed_max) + s(u10m), data = df)
4    gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(pblmin) + s(rh) + s(wspeed) + s(pbl12) + s(wdir) + s(wspeed_max) + s(v10m), data = df)
5 gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(pblmin) + s(rh) + s(wspeed) + s(pbl12) + s(wdir) + s(wspeed_max) + s(pwspeed), data = df)
6      gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(pblmin) + s(rh) + s(wspeed) + s(pbl12) + s(wdir) + s(wspeed_max) + s(sp), data = df)
7   gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(pblmin) + s(rh) + s(wspeed) + s(pbl12) + s(wdir) + s(wspeed_max) + s(pbl00), data = df)
  unlist.aicBack..3...
1             218.0823
2             202.9688
3             206.7522
4             196.2983
5             221.7929
6             200.9048
7             200.7265

Il backward non è migliore.  Verifica della correlazione per mod(N) 

Modello N: pblmin - rh - wspeed - pbl12 - wdir - t2m - wspeed_max 

Scelgo il modello N 

Modelli NON backward: 

---------- START: ################## 

modelli tra cui scegliere: 7 

Modello migliore: 

log(value) ~ weekday + lock + s(mese, bs = "cc", k = 12) + s(jd, 
    k = 5) + s(pblmin) + s(rh) + s(wspeed) + s(pbl12) + s(wdir) + 
    s(t2m) + s(wspeed_max) + s(tp)

Indice: 1 

     [,1]                                                                                                                                                                          
[1,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(pblmin) + s(rh) + s(wspeed) + s(pbl12) + s(wdir) + s(t2m) + s(wspeed_max) + s(tp), data = df)"     
[2,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(pblmin) + s(rh) + s(wspeed) + s(pbl12) + s(wdir) + s(t2m) + s(wspeed_max) + s(ptp), data = df)"    
[3,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(pblmin) + s(rh) + s(wspeed) + s(pbl12) + s(wdir) + s(t2m) + s(wspeed_max) + s(u10m), data = df)"   
[4,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(pblmin) + s(rh) + s(wspeed) + s(pbl12) + s(wdir) + s(t2m) + s(wspeed_max) + s(v10m), data = df)"   
[5,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(pblmin) + s(rh) + s(wspeed) + s(pbl12) + s(wdir) + s(t2m) + s(wspeed_max) + s(pwspeed), data = df)"
[6,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(pblmin) + s(rh) + s(wspeed) + s(pbl12) + s(wdir) + s(t2m) + s(wspeed_max) + s(sp), data = df)"     
[7,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(pblmin) + s(rh) + s(wspeed) + s(pbl12) + s(wdir) + s(t2m) + s(wspeed_max) + s(pbl00), data = df)"  
     [,2]              
[1,] "177.273342207035"
[2,] "182.145275673881"
[3,] "186.623550603915"
[4,] "178.388243764878"
[5,] "200.481974934423"
[6,] "185.819854162862"
[7,] "178.050701031494"

Variabile scelta: tp - AIC 177.27 

Variabili in ICS: 8 

Gli ICS 8 ----- 7 

NOTE: Log Print Time:  2023-09-25 10:08:54.443109 
NOTE: Elapsed Time: 11.1344139575958 secs 

Fine per scelta MODELLO 

pblmin + rh + wspeed + pbl12 + wdir + t2m + wspeed_max 

# Correlation Matrix (pearson-method)

Parameter1 | Parameter2 |         r |         95% CI | t(2920) |         p
--------------------------------------------------------------------------
pbl12      |        t2m |      0.61 | [ 0.59,  0.63] |   41.86 | < .001***
pbl12      |       wdir |      0.43 | [ 0.40,  0.46] |   25.44 | < .001***
pbl12      | wspeed_max |      0.14 | [ 0.11,  0.18] |    7.76 | < .001***
pblmin     |        t2m |     -0.12 | [-0.16, -0.08] |   -6.56 | < .001***
pblmin     |       wdir |     -0.06 | [-0.09, -0.02] |   -3.02 | 0.015*   
pblmin     |     wspeed |      0.67 | [ 0.65,  0.69] |   48.74 | < .001***
pblmin     | wspeed_max |      0.27 | [ 0.24,  0.31] |   15.36 | < .001***
rh         |       wdir |     -0.25 | [-0.29, -0.22] |  -14.09 | < .001***
rh         |     wspeed |     -0.02 | [-0.06,  0.01] |   -1.15 | 0.999    
rh         | wspeed_max |     -0.09 | [-0.12, -0.05] |   -4.74 | < .001***
t2m        | wspeed_max |      0.01 | [-0.02,  0.05] |    0.77 | > .999   
wdir       | wspeed_max | -8.20e-04 | [-0.04,  0.04] |   -0.04 | > .999   

p-value adjustment method: Holm (1979)
Observations: 2922

[1] "s(pblmin)"     "s(rh)"         "s(wspeed)"     "s(pbl12)"     
[5] "s(wdir)"       "s(t2m)"        "s(wspeed_max)"


Family: gaussian 
Link function: log 

Formula:
value ~ weekday + lock + s(mese, bs = "cc", k = 12) + s(jd, k = 5) + 
    s(pblmin) + s(rh) + s(wspeed) + s(pbl12) + s(wdir) + s(t2m) + 
    s(wspeed_max)

Parametric coefficients:
                 Estimate Std. Error t value Pr(>|t|)    
(Intercept)       3.41166    0.01218 280.135  < 2e-16 ***
weekdaygiovedì    0.26014    0.01493  17.418  < 2e-16 ***
weekdaylunedì     0.22320    0.01536  14.532  < 2e-16 ***
weekdaymartedì    0.24756    0.01503  16.472  < 2e-16 ***
weekdaymercoledì  0.25940    0.01499  17.307  < 2e-16 ***
weekdaysabato     0.17102    0.01555  11.001  < 2e-16 ***
weekdayvenerdì    0.28209    0.01491  18.914  < 2e-16 ***
lockL3           -0.33284    0.05374  -6.194 6.74e-10 ***
lockL4           -0.61071    0.08033  -7.602 3.93e-14 ***
lockL5           -0.38184    0.08496  -4.494 7.26e-06 ***
lockL6           -0.22158    0.07941  -2.790   0.0053 ** 
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Approximate significance of smooth terms:
                edf Ref.df     F  p-value    
s(mese)       9.722 10.000 59.01  < 2e-16 ***
s(jd)         3.775  3.969 59.29  < 2e-16 ***
s(pblmin)     5.935  6.867 34.78  < 2e-16 ***
s(rh)         3.610  4.521 58.80  < 2e-16 ***
s(wspeed)     2.132  2.728 69.43  < 2e-16 ***
s(pbl12)      1.607  2.028 55.69  < 2e-16 ***
s(wdir)       6.728  7.844 18.32  < 2e-16 ***
s(t2m)        6.825  7.936 16.72  < 2e-16 ***
s(wspeed_max) 1.872  2.396 10.40 1.46e-05 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

R-sq.(adj) =  0.751   Deviance explained = 75.5%
GCV = 66.909  Scale est. = 64.688    n = 2880

========================================================================= 
Log End Time: 2023-09-25 10:09:18.981208 
Log Elapsed Time: 0 00:01:17 
========================================================================= 
