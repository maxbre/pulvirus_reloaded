========================================================================= 
Log Path: ./log/no2_IT0953A.log 
Program Path: /home/rmorelli/R/pulvirus_reloaded/corso-05a.R 
Working Directory: /home/rmorelli/R/pulvirus_reloaded 
User Name: rmorelli 
R Version: 4.2.2 Patched (2022-11-10 r83330) 
Machine: asiispra x86_64 
Operating System: Linux 5.10.0-21-amd64 #1 SMP Debian 5.10.162-1 (2023-01-21) 
Base Packages: stats graphics grDevices utils datasets methods base Other Packages: datiMeteo_0.0.6 datiInquinanti_0.0.8 stringr_1.5.0 readr_2.1.4 purrr_1.0.1 mgcv_1.8-42 nlme_3.1-162 logr_1.3.3 dplyr_1.1.2 correlation_0.8.4 
Log Start Time: 2023-05-15 10:27:50 
========================================================================= 

# A tibble: 1 × 4
  comune nome_stazione  st_x  st_y
  <chr>  <chr>         <dbl> <dbl>
1 Roma   VILLA ADA      12.5  41.9

NOTE: Data frame has 1 rows and 4 columns. 

NOTE: Log Print Time:  2023-05-15 10:27:50 
NOTE: Elapsed Time: 0.0322728157043457 secs 

Modelli NON backward: 

---------- START: ################## 

modelli tra cui scegliere: 14 

Modello migliore: 

log(value) ~ weekday + lock + s(mese, bs = "cc", k = 12) + s(jd, 
    k = 5) + s(pblmin)

Indice: 14 

      [,1]                                                                                               
 [1,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(t2m), data = df)"       
 [2,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(tp), data = df)"        
 [3,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(ptp), data = df)"       
 [4,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(rh), data = df)"        
 [5,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m), data = df)"      
 [6,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(v10m), data = df)"      
 [7,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(wspeed), data = df)"    
 [8,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(wspeed_max), data = df)"
 [9,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(pwspeed), data = df)"   
[10,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(wdir), data = df)"      
[11,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(sp), data = df)"        
[12,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(pbl00), data = df)"     
[13,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(pbl12), data = df)"     
[14,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(pblmin), data = df)"    
      [,2]              
 [1,] "1508.31896156953"
 [2,] "1493.44083599174"
 [3,] "1452.44322560618"
 [4,] "1582.14535621993"
 [5,] "1399.02643328194"
 [6,] "1218.04307097389"
 [7,] "1176.20394738539"
 [8,] "1406.23775982387"
 [9,] "1447.43749866525"
[10,] "1448.94886933838"
[11,] "1441.99036798582"
[12,] "1224.57923722037"
[13,] "1459.2559747261" 
[14,] "1163.65842805796"

Variabile scelta: pblmin - AIC 1163.66 

Variabili in ICS: 1 

Modelli NON backward: 

---------- START: ################## 

modelli tra cui scegliere: 13 

Modello migliore: 

log(value) ~ weekday + lock + s(mese, bs = "cc", k = 12) + s(jd, 
    k = 5) + s(pblmin) + s(u10m)

Indice: 5 

      [,1]                                                                                                           
 [1,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(pblmin) + s(t2m), data = df)"       
 [2,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(pblmin) + s(tp), data = df)"        
 [3,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(pblmin) + s(ptp), data = df)"       
 [4,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(pblmin) + s(rh), data = df)"        
 [5,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(pblmin) + s(u10m), data = df)"      
 [6,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(pblmin) + s(v10m), data = df)"      
 [7,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(pblmin) + s(wspeed), data = df)"    
 [8,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(pblmin) + s(wspeed_max), data = df)"
 [9,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(pblmin) + s(pwspeed), data = df)"   
[10,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(pblmin) + s(wdir), data = df)"      
[11,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(pblmin) + s(sp), data = df)"        
[12,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(pblmin) + s(pbl00), data = df)"     
[13,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(pblmin) + s(pbl12), data = df)"     
      [,2]              
 [1,] "1160.78797677985"
 [2,] "1183.88418948023"
 [3,] "1157.68691733536"
 [4,] "1191.22663156987"
 [5,] "1068.1567711816" 
 [6,] "1115.83807443979"
 [7,] "1124.83744283865"
 [8,] "1172.17756267423"
 [9,] "1177.77584564023"
[10,] "1107.02175423868"
[11,] "1170.2051390922" 
[12,] "1135.49667885427"
[13,] "1147.05517381535"

Variabile scelta: u10m - AIC 1068.16 

Variabili in ICS: 2 

Gli ICS 2 ----- 1 

NOTE: Log Print Time:  2023-05-15 10:27:54 
NOTE: Elapsed Time: 3.44802904129028 secs 

Il modello N è migliore del precedente, verifica del backward 

Modelli backward: 

modelli tra cui scegliere: 12 

Modello migliore: 

log(value) ~ weekday + lock + s(mese, bs = "cc", k = 12) + s(jd, 
    k = 5) + s(u10m) + s(wspeed)

Indice: 6 

Dati backward: wspeed - 1028.33658234304 

                                                                                                     unlist.w.
1         gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(t2m), data = df)
2          gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(tp), data = df)
3         gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(ptp), data = df)
4          gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(rh), data = df)
5        gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(v10m), data = df)
6      gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(wspeed), data = df)
7  gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(wspeed_max), data = df)
8     gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(pwspeed), data = df)
9        gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(wdir), data = df)
10         gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(sp), data = df)
11      gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(pbl00), data = df)
12      gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(pbl12), data = df)
   unlist.aicBack..3...
1              1354.265
2              1381.146
3              1352.125
4              1438.774
5              1043.815
6              1028.337
7              1303.598
8              1343.320
9              1267.476
10             1353.577
11             1181.582
12             1364.598

Scelgo il BACKWARD 

Modelli NON backward: 

---------- START: ################## 

modelli tra cui scegliere: 12 

Modello migliore: 

log(value) ~ weekday + lock + s(mese, bs = "cc", k = 12) + s(jd, 
    k = 5) + s(u10m) + s(wspeed) + s(pblmin)

Indice: 12 

      [,1]                                                                                                                     
 [1,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(wspeed) + s(t2m), data = df)"       
 [2,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(wspeed) + s(tp), data = df)"        
 [3,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(wspeed) + s(ptp), data = df)"       
 [4,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(wspeed) + s(rh), data = df)"        
 [5,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(wspeed) + s(v10m), data = df)"      
 [6,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(wspeed) + s(wspeed_max), data = df)"
 [7,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(wspeed) + s(pwspeed), data = df)"   
 [8,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(wspeed) + s(wdir), data = df)"      
 [9,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(wspeed) + s(sp), data = df)"        
[10,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(wspeed) + s(pbl00), data = df)"     
[11,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(wspeed) + s(pbl12), data = df)"     
[12,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(wspeed) + s(pblmin), data = df)"    
      [,2]              
 [1,] "1006.68104312396"
 [2,] "1042.93316965883"
 [3,] "1027.93241295824"
 [4,] "1029.14676338586"
 [5,] "1027.54294172561"
 [6,] "1044.85199776311"
 [7,] "1041.41865479331"
 [8,] "1028.16813662818"
 [9,] "1037.84578964283"
[10,] "1010.22937964164"
[11,] "1039.5778711757" 
[12,] "992.906747244635"

Variabile scelta: pblmin - AIC 992.91 

Variabili in ICS: 3 

Gli ICS 3 ----- 2 

NOTE: Log Print Time:  2023-05-15 10:27:57 
NOTE: Elapsed Time: 3.88688802719116 secs 

Il modello N è migliore del precedente, verifica del backward 

Modelli backward: 

modelli tra cui scegliere: 11 

Modello migliore: 

log(value) ~ weekday + lock + s(mese, bs = "cc", k = 12) + s(jd, 
    k = 5) + s(u10m) + s(pblmin) + s(v10m)

Indice: 5 

Dati backward: v10m - 998.118718768806 

                                                                                                                 unlist.w.
1         gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(pblmin) + s(t2m), data = df)
2          gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(pblmin) + s(tp), data = df)
3         gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(pblmin) + s(ptp), data = df)
4          gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(pblmin) + s(rh), data = df)
5        gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(pblmin) + s(v10m), data = df)
6  gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(pblmin) + s(wspeed_max), data = df)
7     gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(pblmin) + s(pwspeed), data = df)
8        gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(pblmin) + s(wdir), data = df)
9          gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(pblmin) + s(sp), data = df)
10      gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(pblmin) + s(pbl00), data = df)
11      gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(pblmin) + s(pbl12), data = df)
   unlist.aicBack..3...
1             1052.4658
2             1089.4953
3             1069.4827
4             1089.1219
5              998.1187
6             1065.2532
7             1085.3900
8             1069.3483
9             1081.8642
10            1063.8721
11            1073.9162

Il backward non è migliore.  Verifica della correlazione per mod(N) 

Modello N: u10m - wspeed - pblmin 

Scelgo il modello N 

Modelli NON backward: 

---------- START: ################## 

modelli tra cui scegliere: 11 

Modello migliore: 

log(value) ~ weekday + lock + s(mese, bs = "cc", k = 12) + s(jd, 
    k = 5) + s(u10m) + s(wspeed) + s(pblmin) + s(t2m)

Indice: 1 

      [,1]                                                                                                                                 
 [1,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(wspeed) + s(pblmin) + s(t2m), data = df)"       
 [2,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(wspeed) + s(pblmin) + s(tp), data = df)"        
 [3,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(wspeed) + s(pblmin) + s(ptp), data = df)"       
 [4,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(wspeed) + s(pblmin) + s(rh), data = df)"        
 [5,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(wspeed) + s(pblmin) + s(v10m), data = df)"      
 [6,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(wspeed) + s(pblmin) + s(wspeed_max), data = df)"
 [7,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(wspeed) + s(pblmin) + s(pwspeed), data = df)"   
 [8,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(wspeed) + s(pblmin) + s(wdir), data = df)"      
 [9,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(wspeed) + s(pblmin) + s(sp), data = df)"        
[10,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(wspeed) + s(pblmin) + s(pbl00), data = df)"     
[11,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(wspeed) + s(pblmin) + s(pbl12), data = df)"     
      [,2]              
 [1,] "977.199920224341"
 [2,] "1010.28823196516"
 [3,] "1002.95170104367"
 [4,] "995.893931045598"
 [5,] "984.82545420771" 
 [6,] "1013.99743943482"
 [7,] "1013.21915051044"
 [8,] "988.209370881352"
 [9,] "1006.52745413927"
[10,] "998.661993772508"
[11,] "1002.96337730519"

Variabile scelta: t2m - AIC 977.2 

Variabili in ICS: 4 

Gli ICS 4 ----- 3 

NOTE: Log Print Time:  2023-05-15 10:28:02 
NOTE: Elapsed Time: 4.07332420349121 secs 

Il modello N è migliore del precedente, verifica del backward 

Modelli backward: 

modelli tra cui scegliere: 10 

Modello migliore: 

log(value) ~ weekday + lock + s(mese, bs = "cc", k = 12) + s(jd, 
    k = 5) + s(u10m) + s(wspeed) + s(t2m) + s(pbl00)

Indice: 9 

Dati backward: pbl00 - 996.274765275815 

                                                                                                                          unlist.w.
1          gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(wspeed) + s(t2m) + s(tp), data = df)
2         gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(wspeed) + s(t2m) + s(ptp), data = df)
3          gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(wspeed) + s(t2m) + s(rh), data = df)
4        gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(wspeed) + s(t2m) + s(v10m), data = df)
5  gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(wspeed) + s(t2m) + s(wspeed_max), data = df)
6     gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(wspeed) + s(t2m) + s(pwspeed), data = df)
7        gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(wspeed) + s(t2m) + s(wdir), data = df)
8          gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(wspeed) + s(t2m) + s(sp), data = df)
9       gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(wspeed) + s(t2m) + s(pbl00), data = df)
10      gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(wspeed) + s(t2m) + s(pbl12), data = df)
   unlist.aicBack..3...
1             1021.9292
2             1009.6431
3             1022.3355
4             1008.5435
5             1025.9320
6             1025.7407
7             1005.9695
8             1014.7876
9              996.2748
10            1014.8714

Il backward non è migliore.  Verifica della correlazione per mod(N) 

Modello N: u10m - wspeed - pblmin - t2m 

Scelgo il modello N 

Modelli NON backward: 

---------- START: ################## 

modelli tra cui scegliere: 10 

Modello migliore: 

log(value) ~ weekday + lock + s(mese, bs = "cc", k = 12) + s(jd, 
    k = 5) + s(u10m) + s(wspeed) + s(pblmin) + s(t2m) + s(v10m)

Indice: 4 

      [,1]                                                                                                                                          
 [1,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(wspeed) + s(pblmin) + s(t2m) + s(tp), data = df)"        
 [2,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(wspeed) + s(pblmin) + s(t2m) + s(ptp), data = df)"       
 [3,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(wspeed) + s(pblmin) + s(t2m) + s(rh), data = df)"        
 [4,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(wspeed) + s(pblmin) + s(t2m) + s(v10m), data = df)"      
 [5,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(wspeed) + s(pblmin) + s(t2m) + s(wspeed_max), data = df)"
 [6,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(wspeed) + s(pblmin) + s(t2m) + s(pwspeed), data = df)"   
 [7,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(wspeed) + s(pblmin) + s(t2m) + s(wdir), data = df)"      
 [8,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(wspeed) + s(pblmin) + s(t2m) + s(sp), data = df)"        
 [9,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(wspeed) + s(pblmin) + s(t2m) + s(pbl00), data = df)"     
[10,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(wspeed) + s(pblmin) + s(t2m) + s(pbl12), data = df)"     
      [,2]              
 [1,] "993.538421759386"
 [2,] "986.841541897803"
 [3,] "995.199188610818"
 [4,] "974.063817171138"
 [5,] "1003.35667712489"
 [6,] "998.742002793755"
 [7,] "975.482430489402"
 [8,] "987.979624094558"
 [9,] "983.445727887595"
[10,] "986.132837646228"

Variabile scelta: v10m - AIC 974.06 

Variabili in ICS: 5 

Gli ICS 5 ----- 4 

NOTE: Log Print Time:  2023-05-15 10:28:06 
NOTE: Elapsed Time: 4.73889064788818 secs 

Il modello N è migliore del precedente, verifica del backward 

Modelli backward: 

modelli tra cui scegliere: 9 

Modello migliore: 

log(value) ~ weekday + lock + s(mese, bs = "cc", k = 12) + s(jd, 
    k = 5) + s(u10m) + s(wspeed) + s(pblmin) + s(v10m) + s(rh)

Indice: 3 

Dati backward: rh - 953.883263256426 

                                                                                                                                      unlist.w.
1         gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(wspeed) + s(pblmin) + s(v10m) + s(tp), data = df)
2        gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(wspeed) + s(pblmin) + s(v10m) + s(ptp), data = df)
3         gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(wspeed) + s(pblmin) + s(v10m) + s(rh), data = df)
4 gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(wspeed) + s(pblmin) + s(v10m) + s(wspeed_max), data = df)
5    gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(wspeed) + s(pblmin) + s(v10m) + s(pwspeed), data = df)
6       gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(wspeed) + s(pblmin) + s(v10m) + s(wdir), data = df)
7         gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(wspeed) + s(pblmin) + s(v10m) + s(sp), data = df)
8      gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(wspeed) + s(pblmin) + s(v10m) + s(pbl00), data = df)
9      gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(wspeed) + s(pblmin) + s(v10m) + s(pbl12), data = df)
  unlist.aicBack..3...
1             996.2175
2             993.1619
3             953.8833
4            1002.6567
5            1006.4087
6             985.2286
7             996.4633
8             989.8043
9             996.5281

Scelgo il BACKWARD 

Modelli NON backward: 

---------- START: ################## 

modelli tra cui scegliere: 8 

Modello migliore: 

log(value) ~ weekday + lock + s(mese, bs = "cc", k = 12) + s(jd, 
    k = 5) + s(u10m) + s(wspeed) + s(pblmin) + s(v10m) + s(rh) + 
    s(pbl12)

Indice: 8 

     [,1]                                                                                                                                                   
[1,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(wspeed) + s(pblmin) + s(v10m) + s(rh) + s(tp), data = df)"        
[2,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(wspeed) + s(pblmin) + s(v10m) + s(rh) + s(ptp), data = df)"       
[3,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(wspeed) + s(pblmin) + s(v10m) + s(rh) + s(wspeed_max), data = df)"
[4,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(wspeed) + s(pblmin) + s(v10m) + s(rh) + s(pwspeed), data = df)"   
[5,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(wspeed) + s(pblmin) + s(v10m) + s(rh) + s(wdir), data = df)"      
[6,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(wspeed) + s(pblmin) + s(v10m) + s(rh) + s(sp), data = df)"        
[7,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(wspeed) + s(pblmin) + s(v10m) + s(rh) + s(pbl00), data = df)"     
[8,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(wspeed) + s(pblmin) + s(v10m) + s(rh) + s(pbl12), data = df)"     
     [,2]              
[1,] "974.684358972993"
[2,] "963.586907918631"
[3,] "988.983536503191"
[4,] "975.724336620213"
[5,] "954.728840580173"
[6,] "961.210246262832"
[7,] "954.296463875418"
[8,] "945.041475121777"

Variabile scelta: pbl12 - AIC 945.04 

Variabili in ICS: 6 

Gli ICS 6 ----- 5 

NOTE: Log Print Time:  2023-05-15 10:28:12 
NOTE: Elapsed Time: 5.66321730613708 secs 

Il modello N è migliore del precedente, verifica del backward 

Modelli backward: 

modelli tra cui scegliere: 7 

Modello migliore: 

log(value) ~ weekday + lock + s(mese, bs = "cc", k = 12) + s(jd, 
    k = 5) + s(u10m) + s(wspeed) + s(pblmin) + s(v10m) + s(pbl12) + 
    s(tp)

Indice: 1 

Dati backward: tp - 1000.29420913173 

                                                                                                                                                 unlist.w.
1         gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(wspeed) + s(pblmin) + s(v10m) + s(pbl12) + s(tp), data = df)
2        gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(wspeed) + s(pblmin) + s(v10m) + s(pbl12) + s(ptp), data = df)
3 gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(wspeed) + s(pblmin) + s(v10m) + s(pbl12) + s(wspeed_max), data = df)
4    gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(wspeed) + s(pblmin) + s(v10m) + s(pbl12) + s(pwspeed), data = df)
5       gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(wspeed) + s(pblmin) + s(v10m) + s(pbl12) + s(wdir), data = df)
6         gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(wspeed) + s(pblmin) + s(v10m) + s(pbl12) + s(sp), data = df)
7      gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(wspeed) + s(pblmin) + s(v10m) + s(pbl12) + s(pbl00), data = df)
  unlist.aicBack..3...
1             1000.294
2             1010.161
3             1007.189
4             1019.303
5             1000.459
6             1012.684
7             1006.577

Il backward non è migliore.  Verifica della correlazione per mod(N) 

Modello N: u10m - wspeed - pblmin - v10m - rh - pbl12 

Scelgo il modello N 

Modelli NON backward: 

---------- START: ################## 

modelli tra cui scegliere: 7 

Modello migliore: 

log(value) ~ weekday + lock + s(mese, bs = "cc", k = 12) + s(jd, 
    k = 5) + s(u10m) + s(wspeed) + s(pblmin) + s(v10m) + s(rh) + 
    s(pbl12) + s(pbl00)

Indice: 7 

     [,1]                                                                                                                                                              
[1,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(wspeed) + s(pblmin) + s(v10m) + s(rh) + s(pbl12) + s(tp), data = df)"        
[2,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(wspeed) + s(pblmin) + s(v10m) + s(rh) + s(pbl12) + s(ptp), data = df)"       
[3,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(wspeed) + s(pblmin) + s(v10m) + s(rh) + s(pbl12) + s(wspeed_max), data = df)"
[4,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(wspeed) + s(pblmin) + s(v10m) + s(rh) + s(pbl12) + s(pwspeed), data = df)"   
[5,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(wspeed) + s(pblmin) + s(v10m) + s(rh) + s(pbl12) + s(wdir), data = df)"      
[6,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(wspeed) + s(pblmin) + s(v10m) + s(rh) + s(pbl12) + s(sp), data = df)"        
[7,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(wspeed) + s(pblmin) + s(v10m) + s(rh) + s(pbl12) + s(pbl00), data = df)"     
     [,2]              
[1,] "963.027919428803"
[2,] "956.48155016347" 
[3,] "960.909664799179"
[4,] "963.589121204002"
[5,] "963.599437356616"
[6,] "951.103673961719"
[7,] "944.920266572841"

Variabile scelta: pbl00 - AIC 944.92 

Variabili in ICS: 7 

Gli ICS 7 ----- 6 

NOTE: Log Print Time:  2023-05-15 10:28:17 
NOTE: Elapsed Time: 5.50645184516907 secs 

Il modello N è migliore del precedente, verifica del backward 

Modelli backward: 

modelli tra cui scegliere: 6 

Modello migliore: 

log(value) ~ weekday + lock + s(mese, bs = "cc", k = 12) + s(jd, 
    k = 5) + s(u10m) + s(wspeed) + s(pblmin) + s(v10m) + s(rh) + 
    s(pbl00) + s(wdir)

Indice: 5 

Dati backward: wdir - 952.743083825766 

                                                                                                                                                         unlist.w.
1         gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(wspeed) + s(pblmin) + s(v10m) + s(rh) + s(pbl00) + s(tp), data = df)
2        gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(wspeed) + s(pblmin) + s(v10m) + s(rh) + s(pbl00) + s(ptp), data = df)
3 gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(wspeed) + s(pblmin) + s(v10m) + s(rh) + s(pbl00) + s(wspeed_max), data = df)
4    gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(wspeed) + s(pblmin) + s(v10m) + s(rh) + s(pbl00) + s(pwspeed), data = df)
5       gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(wspeed) + s(pblmin) + s(v10m) + s(rh) + s(pbl00) + s(wdir), data = df)
6         gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(wspeed) + s(pblmin) + s(v10m) + s(rh) + s(pbl00) + s(sp), data = df)
  unlist.aicBack..3...
1             974.0468
2             964.6027
3             990.0039
4             987.4139
5             952.7431
6             962.2173

Il backward non è migliore.  Verifica della correlazione per mod(N) 

Modello N: u10m - wspeed - pblmin - v10m - rh - pbl12 - pbl00 

Scelgo il modello N 

Modelli NON backward: 

---------- START: ################## 

modelli tra cui scegliere: 6 

Modello migliore: 

log(value) ~ weekday + lock + s(mese, bs = "cc", k = 12) + s(jd, 
    k = 5) + s(u10m) + s(wspeed) + s(pblmin) + s(v10m) + s(rh) + 
    s(pbl12) + s(pbl00) + s(sp)

Indice: 6 

     [,1]                                                                                                                                                                         
[1,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(wspeed) + s(pblmin) + s(v10m) + s(rh) + s(pbl12) + s(pbl00) + s(tp), data = df)"        
[2,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(wspeed) + s(pblmin) + s(v10m) + s(rh) + s(pbl12) + s(pbl00) + s(ptp), data = df)"       
[3,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(wspeed) + s(pblmin) + s(v10m) + s(rh) + s(pbl12) + s(pbl00) + s(wspeed_max), data = df)"
[4,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(wspeed) + s(pblmin) + s(v10m) + s(rh) + s(pbl12) + s(pbl00) + s(pwspeed), data = df)"   
[5,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(wspeed) + s(pblmin) + s(v10m) + s(rh) + s(pbl12) + s(pbl00) + s(wdir), data = df)"      
[6,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(wspeed) + s(pblmin) + s(v10m) + s(rh) + s(pbl12) + s(pbl00) + s(sp), data = df)"        
     [,2]              
[1,] "966.063329282705"
[2,] "980.684720466836"
[3,] "959.100054773877"
[4,] "972.924720027276"
[5,] "963.322530020381"
[6,] "952.949605118281"

Variabile scelta: sp - AIC 952.95 

Variabili in ICS: 8 

Gli ICS 8 ----- 7 

NOTE: Log Print Time:  2023-05-15 10:28:24 
NOTE: Elapsed Time: 6.16299796104431 secs 

Fine per scelta MODELLO 

u10m + wspeed + pblmin + v10m + rh + pbl12 + pbl00 

# Correlation Matrix (pearson-method)

Parameter1 | Parameter2 |     r |         95% CI | t(2920) |         p
----------------------------------------------------------------------
pblmin     |         rh |  0.01 | [-0.02,  0.05] |    0.70 | 0.967    
pblmin     |       v10m |  0.14 | [ 0.11,  0.18] |    7.92 | < .001***
u10m       |       v10m | -0.14 | [-0.18, -0.11] |   -7.91 | < .001***
u10m       |     wspeed | -0.24 | [-0.28, -0.21] |  -13.65 | < .001***

p-value adjustment method: Holm (1979)
Observations: 2922

[1] "s(u10m)"   "s(wspeed)" "s(pblmin)" "s(v10m)"   "s(rh)"     "s(pbl12)" 
[7] "s(pbl00)" 


Family: gaussian 
Link function: log 

Formula:
value ~ weekday + lock + s(mese, bs = "cc", k = 12) + s(jd, k = 5) + 
    s(u10m) + s(wspeed) + s(pblmin) + s(v10m) + s(rh) + s(pbl12) + 
    s(pbl00)

Parametric coefficients:
                  Estimate Std. Error t value Pr(>|t|)    
(Intercept)       3.485395   0.013497 258.226  < 2e-16 ***
weekdayMonday    -0.041138   0.018837  -2.184  0.02906 *  
weekdaySaturday  -0.100613   0.019260  -5.224 1.88e-07 ***
weekdaySunday    -0.242798   0.020935 -11.598  < 2e-16 ***
weekdayThursday  -0.018180   0.018340  -0.991  0.32163    
weekdayTuesday   -0.026377   0.018500  -1.426  0.15404    
weekdayWednesday -0.014232   0.018335  -0.776  0.43770    
lockL3           -0.001079   0.079616  -0.014  0.98919    
lockL4            0.040198   0.079788   0.504  0.61444    
lockL5            0.021998   0.080715   0.273  0.78523    
lockL6            0.235280   0.087853   2.678  0.00745 ** 
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Approximate significance of smooth terms:
            edf Ref.df       F p-value    
s(mese)   9.391 10.000  56.031 < 2e-16 ***
s(jd)     3.963  3.999 158.207 < 2e-16 ***
s(u10m)   2.917  3.773  26.650 < 2e-16 ***
s(wspeed) 1.806  2.295  28.063 < 2e-16 ***
s(pblmin) 6.355  7.318   9.305 < 2e-16 ***
s(v10m)   1.001  1.001  70.383 < 2e-16 ***
s(rh)     5.200  6.302  21.344 < 2e-16 ***
s(pbl12)  3.092  3.938  22.593 < 2e-16 ***
s(pbl00)  2.846  3.572   4.436 0.00204 ** 
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

R-sq.(adj) =  0.603   Deviance explained =   61%
GCV = 91.937  Scale est. = 89.157    n = 2827

========================================================================= 
Log End Time: 2023-05-15 10:28:32 
Log Elapsed Time: 0 00:00:42 
========================================================================= 
