========================================================================= 
Log Path: ./log/no2_IT0953A.log 
Working Directory: /home/rmorelli/R/pulvirus_reloaded 
User Name: rmorelli 
R Version: 4.3.1 (2023-06-16) 
Machine: annuario x86_64 
Operating System: Linux 5.10.0-8-amd64 #1 SMP Debian 5.10.46-5 (2021-09-23) 
Base Packages: stats graphics grDevices utils datasets methods base Other Packages: datiMeteo_0.0.6 datiInquinanti_0.0.7 glue_1.6.2 stringr_1.5.0 readr_2.1.4 purrr_1.0.2 mgcv_1.9-0 nlme_3.1-163 logr_1.3.4 dplyr_1.1.3 correlation_0.8.4 
Log Start Time: 2023-09-25 10:01:43.546935 
========================================================================= 

# A tibble: 1 × 4
  comune nome_stazione  st_x  st_y
  <chr>  <chr>         <dbl> <dbl>
1 Roma   VILLA ADA      12.5  41.9

NOTE: Data frame has 1 rows and 4 columns. 

NOTE: Log Print Time:  2023-09-25 10:01:43.584709 
NOTE: Elapsed Time: 0.0372638702392578 secs 

Modelli NON backward: 

---------- START: ################## 

modelli tra cui scegliere: 14 

Modello migliore: 

log(value) ~ weekday + lock + s(mese, bs = "cc", k = 12) + s(jd, 
    k = 5) + s(pblmin)

Indice: 14 

      [,1]                                                                                               
 [1,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(t2m), data = df)"       
 [2,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(tp), data = df)"        
 [3,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(ptp), data = df)"       
 [4,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(rh), data = df)"        
 [5,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m), data = df)"      
 [6,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(v10m), data = df)"      
 [7,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(wspeed), data = df)"    
 [8,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(wspeed_max), data = df)"
 [9,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(pwspeed), data = df)"   
[10,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(wdir), data = df)"      
[11,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(sp), data = df)"        
[12,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(pbl00), data = df)"     
[13,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(pbl12), data = df)"     
[14,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(pblmin), data = df)"    
      [,2]              
 [1,] "1508.31896156953"
 [2,] "1493.44083599174"
 [3,] "1452.44322560618"
 [4,] "1582.14535621993"
 [5,] "1399.02643328192"
 [6,] "1218.04307097389"
 [7,] "1176.20394738538"
 [8,] "1406.23775982387"
 [9,] "1447.4374986652" 
[10,] "1448.94886933837"
[11,] "1441.99036798582"
[12,] "1224.57923722037"
[13,] "1459.2559747261" 
[14,] "1163.65842805798"

Variabile scelta: pblmin - AIC 1163.66 

Variabili in ICS: 1 

Modelli NON backward: 

---------- START: ################## 

modelli tra cui scegliere: 13 

Modello migliore: 

log(value) ~ weekday + lock + s(mese, bs = "cc", k = 12) + s(jd, 
    k = 5) + s(pblmin) + s(u10m)

Indice: 5 

      [,1]                                                                                                           
 [1,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(pblmin) + s(t2m), data = df)"       
 [2,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(pblmin) + s(tp), data = df)"        
 [3,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(pblmin) + s(ptp), data = df)"       
 [4,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(pblmin) + s(rh), data = df)"        
 [5,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(pblmin) + s(u10m), data = df)"      
 [6,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(pblmin) + s(v10m), data = df)"      
 [7,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(pblmin) + s(wspeed), data = df)"    
 [8,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(pblmin) + s(wspeed_max), data = df)"
 [9,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(pblmin) + s(pwspeed), data = df)"   
[10,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(pblmin) + s(wdir), data = df)"      
[11,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(pblmin) + s(sp), data = df)"        
[12,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(pblmin) + s(pbl00), data = df)"     
[13,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(pblmin) + s(pbl12), data = df)"     
      [,2]              
 [1,] "1160.7879767799" 
 [2,] "1183.88418948028"
 [3,] "1157.68691733542"
 [4,] "1191.22663156991"
 [5,] "1068.15677118158"
 [6,] "1115.8380744398" 
 [7,] "1124.83744283869"
 [8,] "1172.17756267429"
 [9,] "1177.77584564028"
[10,] "1107.02175423868"
[11,] "1170.20513909221"
[12,] "1135.4966788543" 
[13,] "1147.05517381536"

Variabile scelta: u10m - AIC 1068.16 

Variabili in ICS: 2 

Gli ICS 2 ----- 1 

NOTE: Log Print Time:  2023-09-25 10:01:48.856541 
NOTE: Elapsed Time: 5.27183127403259 secs 

Il modello N è migliore del precedente, verifica del backward 

Modelli backward: 

modelli tra cui scegliere: 12 

Modello migliore: 

log(value) ~ weekday + lock + s(mese, bs = "cc", k = 12) + s(jd, 
    k = 5) + s(u10m) + s(wspeed)

Indice: 6 

Dati backward: wspeed - 1028.33658234302 

                                                                                                     unlist.w.
1         gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(t2m), data = df)
2          gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(tp), data = df)
3         gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(ptp), data = df)
4          gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(rh), data = df)
5        gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(v10m), data = df)
6      gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(wspeed), data = df)
7  gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(wspeed_max), data = df)
8     gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(pwspeed), data = df)
9        gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(wdir), data = df)
10         gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(sp), data = df)
11      gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(pbl00), data = df)
12      gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(pbl12), data = df)
   unlist.aicBack..3...
1              1354.265
2              1381.146
3              1352.125
4              1438.774
5              1043.815
6              1028.337
7              1303.598
8              1343.320
9              1267.476
10             1353.577
11             1181.582
12             1364.598

Scelgo il BACKWARD 

Modelli NON backward: 

---------- START: ################## 

modelli tra cui scegliere: 12 

Modello migliore: 

log(value) ~ weekday + lock + s(mese, bs = "cc", k = 12) + s(jd, 
    k = 5) + s(u10m) + s(wspeed) + s(pblmin)

Indice: 12 

      [,1]                                                                                                                     
 [1,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(wspeed) + s(t2m), data = df)"       
 [2,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(wspeed) + s(tp), data = df)"        
 [3,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(wspeed) + s(ptp), data = df)"       
 [4,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(wspeed) + s(rh), data = df)"        
 [5,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(wspeed) + s(v10m), data = df)"      
 [6,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(wspeed) + s(wspeed_max), data = df)"
 [7,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(wspeed) + s(pwspeed), data = df)"   
 [8,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(wspeed) + s(wdir), data = df)"      
 [9,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(wspeed) + s(sp), data = df)"        
[10,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(wspeed) + s(pbl00), data = df)"     
[11,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(wspeed) + s(pbl12), data = df)"     
[12,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(wspeed) + s(pblmin), data = df)"    
      [,2]              
 [1,] "1006.68104312394"
 [2,] "1042.93316965881"
 [3,] "1027.93241295821"
 [4,] "1029.14676338585"
 [5,] "1027.54294172564"
 [6,] "1044.85199776308"
 [7,] "1041.41865479328"
 [8,] "1028.16813662812"
 [9,] "1037.84578964282"
[10,] "1010.22937964163"
[11,] "1039.57787117569"
[12,] "992.9067472446"  

Variabile scelta: pblmin - AIC 992.91 

Variabili in ICS: 3 

Gli ICS 3 ----- 2 

NOTE: Log Print Time:  2023-09-25 10:01:54.357395 
NOTE: Elapsed Time: 5.50085401535034 secs 

Il modello N è migliore del precedente, verifica del backward 

Modelli backward: 

modelli tra cui scegliere: 11 

Modello migliore: 

log(value) ~ weekday + lock + s(mese, bs = "cc", k = 12) + s(jd, 
    k = 5) + s(u10m) + s(pblmin) + s(v10m)

Indice: 5 

Dati backward: v10m - 998.118718768808 

                                                                                                                 unlist.w.
1         gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(pblmin) + s(t2m), data = df)
2          gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(pblmin) + s(tp), data = df)
3         gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(pblmin) + s(ptp), data = df)
4          gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(pblmin) + s(rh), data = df)
5        gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(pblmin) + s(v10m), data = df)
6  gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(pblmin) + s(wspeed_max), data = df)
7     gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(pblmin) + s(pwspeed), data = df)
8        gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(pblmin) + s(wdir), data = df)
9          gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(pblmin) + s(sp), data = df)
10      gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(pblmin) + s(pbl00), data = df)
11      gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(pblmin) + s(pbl12), data = df)
   unlist.aicBack..3...
1             1052.4658
2             1089.4953
3             1069.4827
4             1089.1219
5              998.1187
6             1065.2532
7             1085.3900
8             1069.3483
9             1081.8642
10            1063.8721
11            1073.9162

Il backward non è migliore.  Verifica della correlazione per mod(N) 

Modello N: u10m - wspeed - pblmin 

Scelgo il modello N 

Modelli NON backward: 

---------- START: ################## 

modelli tra cui scegliere: 11 

Modello migliore: 

log(value) ~ weekday + lock + s(mese, bs = "cc", k = 12) + s(jd, 
    k = 5) + s(u10m) + s(wspeed) + s(pblmin) + s(t2m)

Indice: 1 

      [,1]                                                                                                                                 
 [1,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(wspeed) + s(pblmin) + s(t2m), data = df)"       
 [2,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(wspeed) + s(pblmin) + s(tp), data = df)"        
 [3,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(wspeed) + s(pblmin) + s(ptp), data = df)"       
 [4,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(wspeed) + s(pblmin) + s(rh), data = df)"        
 [5,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(wspeed) + s(pblmin) + s(v10m), data = df)"      
 [6,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(wspeed) + s(pblmin) + s(wspeed_max), data = df)"
 [7,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(wspeed) + s(pblmin) + s(pwspeed), data = df)"   
 [8,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(wspeed) + s(pblmin) + s(wdir), data = df)"      
 [9,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(wspeed) + s(pblmin) + s(sp), data = df)"        
[10,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(wspeed) + s(pblmin) + s(pbl00), data = df)"     
[11,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(wspeed) + s(pblmin) + s(pbl12), data = df)"     
      [,2]              
 [1,] "977.199920224309"
 [2,] "1010.28823196512"
 [3,] "1002.95170104364"
 [4,] "995.893931045566"
 [5,] "984.825454207719"
 [6,] "1013.99743943473"
 [7,] "1013.2191505104" 
 [8,] "988.209370881322"
 [9,] "1006.52745413924"
[10,] "998.66199377247" 
[11,] "1002.96337730515"

Variabile scelta: t2m - AIC 977.2 

Variabili in ICS: 4 

Gli ICS 4 ----- 3 

NOTE: Log Print Time:  2023-09-25 10:02:00.274136 
NOTE: Elapsed Time: 5.91674089431763 secs 

Il modello N è migliore del precedente, verifica del backward 

Modelli backward: 

modelli tra cui scegliere: 10 

Modello migliore: 

log(value) ~ weekday + lock + s(mese, bs = "cc", k = 12) + s(jd, 
    k = 5) + s(u10m) + s(wspeed) + s(t2m) + s(pbl00)

Indice: 9 

Dati backward: pbl00 - 996.274765275801 

                                                                                                                          unlist.w.
1          gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(wspeed) + s(t2m) + s(tp), data = df)
2         gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(wspeed) + s(t2m) + s(ptp), data = df)
3          gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(wspeed) + s(t2m) + s(rh), data = df)
4        gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(wspeed) + s(t2m) + s(v10m), data = df)
5  gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(wspeed) + s(t2m) + s(wspeed_max), data = df)
6     gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(wspeed) + s(t2m) + s(pwspeed), data = df)
7        gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(wspeed) + s(t2m) + s(wdir), data = df)
8          gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(wspeed) + s(t2m) + s(sp), data = df)
9       gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(wspeed) + s(t2m) + s(pbl00), data = df)
10      gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(wspeed) + s(t2m) + s(pbl12), data = df)
   unlist.aicBack..3...
1             1021.9292
2             1009.6431
3             1022.3355
4             1008.5435
5             1025.9320
6             1025.7407
7             1005.9695
8             1014.7876
9              996.2748
10            1014.8714

Il backward non è migliore.  Verifica della correlazione per mod(N) 

Modello N: u10m - wspeed - pblmin - t2m 

Scelgo il modello N 

Modelli NON backward: 

---------- START: ################## 

modelli tra cui scegliere: 10 

Modello migliore: 

log(value) ~ weekday + lock + s(mese, bs = "cc", k = 12) + s(jd, 
    k = 5) + s(u10m) + s(wspeed) + s(pblmin) + s(t2m) + s(v10m)

Indice: 4 

      [,1]                                                                                                                                          
 [1,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(wspeed) + s(pblmin) + s(t2m) + s(tp), data = df)"        
 [2,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(wspeed) + s(pblmin) + s(t2m) + s(ptp), data = df)"       
 [3,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(wspeed) + s(pblmin) + s(t2m) + s(rh), data = df)"        
 [4,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(wspeed) + s(pblmin) + s(t2m) + s(v10m), data = df)"      
 [5,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(wspeed) + s(pblmin) + s(t2m) + s(wspeed_max), data = df)"
 [6,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(wspeed) + s(pblmin) + s(t2m) + s(pwspeed), data = df)"   
 [7,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(wspeed) + s(pblmin) + s(t2m) + s(wdir), data = df)"      
 [8,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(wspeed) + s(pblmin) + s(t2m) + s(sp), data = df)"        
 [9,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(wspeed) + s(pblmin) + s(t2m) + s(pbl00), data = df)"     
[10,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(wspeed) + s(pblmin) + s(t2m) + s(pbl12), data = df)"     
      [,2]              
 [1,] "993.538421759324"
 [2,] "986.841541897753"
 [3,] "995.199188610777"
 [4,] "974.063817171112"
 [5,] "1003.35667712479"
 [6,] "998.742002793705"
 [7,] "975.48243048937" 
 [8,] "987.979624094502"
 [9,] "983.445727887554"
[10,] "986.132837646165"

Variabile scelta: v10m - AIC 974.06 

Variabili in ICS: 5 

Gli ICS 5 ----- 4 

NOTE: Log Print Time:  2023-09-25 10:02:06.73823 
NOTE: Elapsed Time: 6.46409392356873 secs 

Il modello N è migliore del precedente, verifica del backward 

Modelli backward: 

modelli tra cui scegliere: 9 

Modello migliore: 

log(value) ~ weekday + lock + s(mese, bs = "cc", k = 12) + s(jd, 
    k = 5) + s(u10m) + s(wspeed) + s(pblmin) + s(v10m) + s(rh)

Indice: 3 

Dati backward: rh - 953.883263256468 

                                                                                                                                      unlist.w.
1         gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(wspeed) + s(pblmin) + s(v10m) + s(tp), data = df)
2        gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(wspeed) + s(pblmin) + s(v10m) + s(ptp), data = df)
3         gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(wspeed) + s(pblmin) + s(v10m) + s(rh), data = df)
4 gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(wspeed) + s(pblmin) + s(v10m) + s(wspeed_max), data = df)
5    gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(wspeed) + s(pblmin) + s(v10m) + s(pwspeed), data = df)
6       gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(wspeed) + s(pblmin) + s(v10m) + s(wdir), data = df)
7         gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(wspeed) + s(pblmin) + s(v10m) + s(sp), data = df)
8      gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(wspeed) + s(pblmin) + s(v10m) + s(pbl00), data = df)
9      gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(wspeed) + s(pblmin) + s(v10m) + s(pbl12), data = df)
  unlist.aicBack..3...
1             996.2175
2             993.1619
3             953.8833
4            1002.6567
5            1006.4087
6             985.2286
7             996.4633
8             989.8043
9             996.5281

Scelgo il BACKWARD 

Modelli NON backward: 

---------- START: ################## 

modelli tra cui scegliere: 8 

Modello migliore: 

log(value) ~ weekday + lock + s(mese, bs = "cc", k = 12) + s(jd, 
    k = 5) + s(u10m) + s(wspeed) + s(pblmin) + s(v10m) + s(rh) + 
    s(pbl12)

Indice: 8 

     [,1]                                                                                                                                                   
[1,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(wspeed) + s(pblmin) + s(v10m) + s(rh) + s(tp), data = df)"        
[2,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(wspeed) + s(pblmin) + s(v10m) + s(rh) + s(ptp), data = df)"       
[3,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(wspeed) + s(pblmin) + s(v10m) + s(rh) + s(wspeed_max), data = df)"
[4,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(wspeed) + s(pblmin) + s(v10m) + s(rh) + s(pwspeed), data = df)"   
[5,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(wspeed) + s(pblmin) + s(v10m) + s(rh) + s(wdir), data = df)"      
[6,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(wspeed) + s(pblmin) + s(v10m) + s(rh) + s(sp), data = df)"        
[7,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(wspeed) + s(pblmin) + s(v10m) + s(rh) + s(pbl00), data = df)"     
[8,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(wspeed) + s(pblmin) + s(v10m) + s(rh) + s(pbl12), data = df)"     
     [,2]              
[1,] "974.684358972773"
[2,] "963.586907918542"
[3,] "988.98353650315" 
[4,] "975.724336616712"
[5,] "954.728840580168"
[6,] "961.210246262886"
[7,] "954.296463875452"
[8,] "945.041475121785"

Variabile scelta: pbl12 - AIC 945.04 

Variabili in ICS: 6 

Gli ICS 6 ----- 5 

NOTE: Log Print Time:  2023-09-25 10:02:13.904523 
NOTE: Elapsed Time: 7.16629338264465 secs 

Il modello N è migliore del precedente, verifica del backward 

Modelli backward: 

modelli tra cui scegliere: 7 

Modello migliore: 

log(value) ~ weekday + lock + s(mese, bs = "cc", k = 12) + s(jd, 
    k = 5) + s(u10m) + s(wspeed) + s(pblmin) + s(v10m) + s(pbl12) + 
    s(tp)

Indice: 1 

Dati backward: tp - 1000.29420913173 

                                                                                                                                                 unlist.w.
1         gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(wspeed) + s(pblmin) + s(v10m) + s(pbl12) + s(tp), data = df)
2        gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(wspeed) + s(pblmin) + s(v10m) + s(pbl12) + s(ptp), data = df)
3 gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(wspeed) + s(pblmin) + s(v10m) + s(pbl12) + s(wspeed_max), data = df)
4    gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(wspeed) + s(pblmin) + s(v10m) + s(pbl12) + s(pwspeed), data = df)
5       gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(wspeed) + s(pblmin) + s(v10m) + s(pbl12) + s(wdir), data = df)
6         gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(wspeed) + s(pblmin) + s(v10m) + s(pbl12) + s(sp), data = df)
7      gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(wspeed) + s(pblmin) + s(v10m) + s(pbl12) + s(pbl00), data = df)
  unlist.aicBack..3...
1             1000.294
2             1010.161
3             1007.189
4             1019.303
5             1000.459
6             1012.684
7             1006.577

Il backward non è migliore.  Verifica della correlazione per mod(N) 

Modello N: u10m - wspeed - pblmin - v10m - rh - pbl12 

Scelgo il modello N 

Modelli NON backward: 

---------- START: ################## 

modelli tra cui scegliere: 7 

Modello migliore: 

log(value) ~ weekday + lock + s(mese, bs = "cc", k = 12) + s(jd, 
    k = 5) + s(u10m) + s(wspeed) + s(pblmin) + s(v10m) + s(rh) + 
    s(pbl12) + s(pbl00)

Indice: 7 

     [,1]                                                                                                                                                              
[1,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(wspeed) + s(pblmin) + s(v10m) + s(rh) + s(pbl12) + s(tp), data = df)"        
[2,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(wspeed) + s(pblmin) + s(v10m) + s(rh) + s(pbl12) + s(ptp), data = df)"       
[3,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(wspeed) + s(pblmin) + s(v10m) + s(rh) + s(pbl12) + s(wspeed_max), data = df)"
[4,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(wspeed) + s(pblmin) + s(v10m) + s(rh) + s(pbl12) + s(pwspeed), data = df)"   
[5,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(wspeed) + s(pblmin) + s(v10m) + s(rh) + s(pbl12) + s(wdir), data = df)"      
[6,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(wspeed) + s(pblmin) + s(v10m) + s(rh) + s(pbl12) + s(sp), data = df)"        
[7,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(wspeed) + s(pblmin) + s(v10m) + s(rh) + s(pbl12) + s(pbl00), data = df)"     
     [,2]              
[1,] "963.027919428805"
[2,] "956.481550163439"
[3,] "960.909664799314"
[4,] "963.589121206501"
[5,] "963.599437356571"
[6,] "951.103673961857"
[7,] "944.920266572883"

Variabile scelta: pbl00 - AIC 944.92 

Variabili in ICS: 7 

Gli ICS 7 ----- 6 

NOTE: Log Print Time:  2023-09-25 10:02:20.987607 
NOTE: Elapsed Time: 7.08308410644531 secs 

Il modello N è migliore del precedente, verifica del backward 

Modelli backward: 

modelli tra cui scegliere: 6 

Modello migliore: 

log(value) ~ weekday + lock + s(mese, bs = "cc", k = 12) + s(jd, 
    k = 5) + s(u10m) + s(wspeed) + s(pblmin) + s(v10m) + s(rh) + 
    s(pbl00) + s(wdir)

Indice: 5 

Dati backward: wdir - 952.743083826004 

                                                                                                                                                         unlist.w.
1         gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(wspeed) + s(pblmin) + s(v10m) + s(rh) + s(pbl00) + s(tp), data = df)
2        gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(wspeed) + s(pblmin) + s(v10m) + s(rh) + s(pbl00) + s(ptp), data = df)
3 gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(wspeed) + s(pblmin) + s(v10m) + s(rh) + s(pbl00) + s(wspeed_max), data = df)
4    gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(wspeed) + s(pblmin) + s(v10m) + s(rh) + s(pbl00) + s(pwspeed), data = df)
5       gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(wspeed) + s(pblmin) + s(v10m) + s(rh) + s(pbl00) + s(wdir), data = df)
6         gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(wspeed) + s(pblmin) + s(v10m) + s(rh) + s(pbl00) + s(sp), data = df)
  unlist.aicBack..3...
1             974.0468
2             964.6027
3             990.0039
4             987.4139
5             952.7431
6             962.2173

Il backward non è migliore.  Verifica della correlazione per mod(N) 

Modello N: u10m - wspeed - pblmin - v10m - rh - pbl12 - pbl00 

Scelgo il modello N 

Modelli NON backward: 

---------- START: ################## 

modelli tra cui scegliere: 6 

Modello migliore: 

log(value) ~ weekday + lock + s(mese, bs = "cc", k = 12) + s(jd, 
    k = 5) + s(u10m) + s(wspeed) + s(pblmin) + s(v10m) + s(rh) + 
    s(pbl12) + s(pbl00) + s(sp)

Indice: 6 

     [,1]                                                                                                                                                                         
[1,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(wspeed) + s(pblmin) + s(v10m) + s(rh) + s(pbl12) + s(pbl00) + s(tp), data = df)"        
[2,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(wspeed) + s(pblmin) + s(v10m) + s(rh) + s(pbl12) + s(pbl00) + s(ptp), data = df)"       
[3,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(wspeed) + s(pblmin) + s(v10m) + s(rh) + s(pbl12) + s(pbl00) + s(wspeed_max), data = df)"
[4,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(wspeed) + s(pblmin) + s(v10m) + s(rh) + s(pbl12) + s(pbl00) + s(pwspeed), data = df)"   
[5,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(wspeed) + s(pblmin) + s(v10m) + s(rh) + s(pbl12) + s(pbl00) + s(wdir), data = df)"      
[6,] "gam(log(value) ~ weekday + lock + s(mese, bs='cc', k=12) + s(jd, k=5) + s(u10m) + s(wspeed) + s(pblmin) + s(v10m) + s(rh) + s(pbl12) + s(pbl00) + s(sp), data = df)"        
     [,2]              
[1,] "966.063329282756"
[2,] "980.684720465643"
[3,] "959.100054773892"
[4,] "972.924720012719"
[5,] "963.322530020325"
[6,] "952.949605118233"

Variabile scelta: sp - AIC 952.95 

Variabili in ICS: 8 

Gli ICS 8 ----- 7 

NOTE: Log Print Time:  2023-09-25 10:02:28.92959 
NOTE: Elapsed Time: 7.94198346138 secs 

Fine per scelta MODELLO 

u10m + wspeed + pblmin + v10m + rh + pbl12 + pbl00 

# Correlation Matrix (pearson-method)

Parameter1 | Parameter2 |     r |         95% CI | t(2920) |         p
----------------------------------------------------------------------
pblmin     |         rh |  0.01 | [-0.02,  0.05] |    0.70 | 0.967    
pblmin     |       v10m |  0.14 | [ 0.11,  0.18] |    7.92 | < .001***
u10m       |       v10m | -0.14 | [-0.18, -0.11] |   -7.91 | < .001***
u10m       |     wspeed | -0.24 | [-0.28, -0.21] |  -13.65 | < .001***

p-value adjustment method: Holm (1979)
Observations: 2922

[1] "s(u10m)"   "s(wspeed)" "s(pblmin)" "s(v10m)"   "s(rh)"     "s(pbl12)" 
[7] "s(pbl00)" 


Family: gaussian 
Link function: log 

Formula:
value ~ weekday + lock + s(mese, bs = "cc", k = 12) + s(jd, k = 5) + 
    s(u10m) + s(wspeed) + s(pblmin) + s(v10m) + s(rh) + s(pbl12) + 
    s(pbl00)

Parametric coefficients:
                  Estimate Std. Error t value Pr(>|t|)    
(Intercept)       3.242597   0.016917 191.682  < 2e-16 ***
weekdaygiovedì    0.224618   0.020952  10.721  < 2e-16 ***
weekdaylunedì     0.201660   0.021372   9.436  < 2e-16 ***
weekdaymartedì    0.216421   0.021070  10.271  < 2e-16 ***
weekdaymercoledì  0.228566   0.020954  10.908  < 2e-16 ***
weekdaysabato     0.142185   0.021751   6.537 7.44e-11 ***
weekdayvenerdì    0.242798   0.020935  11.598  < 2e-16 ***
lockL3           -0.001079   0.079616  -0.014  0.98919    
lockL4            0.040198   0.079788   0.504  0.61444    
lockL5            0.021998   0.080715   0.273  0.78523    
lockL6            0.235280   0.087853   2.678  0.00745 ** 
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Approximate significance of smooth terms:
            edf Ref.df       F p-value    
s(mese)   9.391 10.000  56.031 < 2e-16 ***
s(jd)     3.963  3.999 158.207 < 2e-16 ***
s(u10m)   2.917  3.773  26.650 < 2e-16 ***
s(wspeed) 1.806  2.295  28.063 < 2e-16 ***
s(pblmin) 6.355  7.318   9.305 < 2e-16 ***
s(v10m)   1.001  1.001  70.383 < 2e-16 ***
s(rh)     5.200  6.302  21.344 < 2e-16 ***
s(pbl12)  3.092  3.938  22.593 < 2e-16 ***
s(pbl00)  2.846  3.572   4.436 0.00204 ** 
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

R-sq.(adj) =  0.603   Deviance explained =   61%
GCV = 91.937  Scale est. = 89.157    n = 2827

========================================================================= 
Log End Time: 2023-09-25 10:03:09.600842 
Log Elapsed Time: 0 00:01:26 
========================================================================= 
